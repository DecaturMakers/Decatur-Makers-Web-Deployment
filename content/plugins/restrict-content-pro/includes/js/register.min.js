function rcp_validate_form(e){rcp_validate_subscription_level(),e&&rcp_validate_gateways(),rcp_validate_discount()}function rcp_validate_subscription_level(){if(!rcp_validating_level){var e=jQuery,a=!1,r=jQuery("#rcp_subscription_levels input:checked"),_=e(".rcp_gateway_fields").hasClass("rcp_discounted_100");rcp_validating_level=!0,0==r.attr("rel")&&(a=!0),a?(e(".rcp_gateway_fields,#rcp_auto_renew_wrap,#rcp_discount_code_wrap").hide(),e(".rcp_gateway_fields").removeClass("rcp_discounted_100"),e("#rcp_discount_code_wrap input").val(""),e(".rcp_discount_amount,#rcp_gateway_extra_fields").remove(),e(".rcp_discount_valid, .rcp_discount_invalid").hide(),e("#rcp_auto_renew_wrap input").attr("checked",!1)):(_?e("#rcp_gateway_extra_fields").remove():e(".rcp_gateway_fields,#rcp_auto_renew_wrap").show(),e("#rcp_discount_code_wrap").show()),rcp_validating_level=!1}}function rcp_validate_gateways(){if(!rcp_validating_gateway){var e,a=jQuery,r=a("#rcp_registration_form"),_=!1,c=jQuery("#rcp_subscription_levels input:checked"),t=a(".rcp_gateway_fields").hasClass("rcp_discounted_100");if(rcp_validating_gateway=!0,0==c.attr("rel")&&(_=!0),a(".rcp_message.error",r).remove(),a("#rcp_payment_gateways").length>0?(e=a("#rcp_payment_gateways select option:selected"),e.length<1&&(e=a('input[name="rcp_gateway"]:checked'))):e=a('input[name="rcp_gateway"]'),_)a(".rcp_gateway_fields").hide(),a("#rcp_auto_renew_wrap").hide(),a("#rcp_auto_renew_wrap input").attr("checked",!1),a("#rcp_gateway_extra_fields").remove();else{if(t)a("#rcp_gateway_extra_fields").remove();else{r.block({message:rcp_script_options.pleasewait,css:{border:"none",padding:"15px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.5,color:"#fff"}}),a(".rcp_gateway_fields").show();var i={action:"rcp_load_gateway_fields",rcp_gateway:e.val()};a.post(rcp_script_options.ajaxurl,i,function(_){a("#rcp_gateway_extra_fields").remove(),_.success&&_.data.fields&&a('<div class="rcp_gateway_'+e.val()+'_fields" id="rcp_gateway_extra_fields">'+_.data.fields+"</div>").insertAfter(a(".rcp_gateway_fields").length?".rcp_gateway_fields":".rcp_gateways_fieldset"),r.unblock()})}"yes"!=e.data("supports-recurring")||t?(a("#rcp_auto_renew_wrap").hide(),a("#rcp_auto_renew_wrap input").attr("checked",!1)):a("#rcp_auto_renew_wrap").show(),a("#rcp_discount_code_wrap").show()}rcp_validating_gateway=!1}}function rcp_validate_discount(){if(!rcp_validating_discount){var e=jQuery,a=e(".rcp_gateway_fields"),r=e("#rcp_discount_code").val();if(e('input[name="rcp_level"]').length)var _=e('input[name="rcp_level"]').val();else var _=e("#rcp_subscription_levels input:checked").val();if(r){var c={action:"validate_discount",code:r,subscription_id:_};rcp_validating_discount=!0,e.post(rcp_script_options.ajaxurl,c,function(r){e(".rcp_discount_amount").remove(),e(".rcp_discount_valid, .rcp_discount_invalid").hide(),r.valid?r.valid&&(e(".rcp_discount_valid").show(),e("#rcp_discount_code_wrap label").append('<span class="rcp_discount_amount"> - '+r.amount+"</span>"),r.full?(e("#rcp_auto_renew_wrap").hide(),a.hide().addClass("rcp_discounted_100"),e("#rcp_gateway_extra_fields").remove()):(e("#rcp_auto_renew_wrap").show(),a.show().removeClass("rcp_discounted_100"))):(e(".rcp_discount_invalid").show(),a.removeClass("rcp_discounted_100"),e(".rcp_gateway_fields,#rcp_auto_renew_wrap").show()),rcp_validating_discount=!1,e("body").trigger("rcp_discount_applied",[r])})}}}var rcp_validating_discount=!1,rcp_validating_gateway=!1,rcp_validating_level=!1;jQuery(document).ready(function(e){rcp_validate_form(!0),e("#rcp_payment_gateways select, #rcp_payment_gateways input").change(function(){e("body").trigger("rcp_gateway_change")}),e(".rcp_level").change(function(){e("body").trigger("rcp_level_change")}),e("body").on("rcp_gateway_change",function(){rcp_validate_form(!0)}).on("rcp_level_change",function(){rcp_validate_form(!0)}),e("#rcp_discount_code").keyup(function(a){13!=a.which&&rcp_validate_discount(e(this).val())}),e(document).on("click","#rcp_registration_form #rcp_submit",function(a){var r=document.getElementById("rcp_registration_form"),_=e("#rcp_registration_form");if("function"!=typeof r.checkValidity||!1!==r.checkValidity()){a.preventDefault();var c=e(this).val();_.block({message:rcp_script_options.pleasewait,css:{border:"none",padding:"15px",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px",opacity:.5,color:"#fff"}}),e("#rcp_submit",_).val(rcp_script_options.pleasewait),e.post(rcp_script_options.ajaxurl,_.serialize()+"&action=rcp_process_register_form&rcp_ajax=true",function(a){e(".rcp-submit-ajax",_).remove(),e(".rcp_message.error",_).remove(),a.success?(e("body").trigger("rcp_register_form_submission"),e(r).submit()):(e("#rcp_submit",_).val(c),e("#rcp_submit",_).before(a.data.errors),e("#rcp_register_nonce",_).val(a.data.nonce),_.unblock())}).done(function(){}).fail(function(e){console.log(e)}).always(function(){})}})});